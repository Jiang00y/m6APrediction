% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{prediction_multiple}
\alias{prediction_multiple}
\title{Predict m6A probability and status for multiple observations}
\usage{
prediction_multiple(ml_fit, feature_df, positive_threshold = 0.5)
}
\arguments{
\item{ml_fit}{A fitted classification model that supports
\code{predict(ml_fit, newdata, type = "prob")}, e.g. an object returned by
\code{randomForest::randomForest()} trained on the m6A data.}

\item{feature_df}{A data frame containing at least the following columns:
\itemize{
\item \code{gc_content} (numeric)
\item \code{RNA_type} (character or factor; one of
\code{"mRNA"}, \code{"lincRNA"}, \code{"lncRNA"}, \code{"pseudogene"})
\item \code{RNA_region} (character or factor; one of
\code{"CDS"}, \code{"intron"}, \code{"3'UTR"}, \code{"5'UTR"})
\item \code{exon_length} (numeric)
\item \code{distance_to_junction} (numeric)
\item \code{evolutionary_conservation} (numeric)
\item \code{DNA_5mer} (character; DNA string of length 5)
}}

\item{positive_threshold}{A numeric value between 0 and 1 specifying the
probability cutoff above which an observation is labelled
\code{"Positive"}. Defaults to \code{0.5}.}
}
\value{
A data frame equal to \code{feature_df} with two additional columns:
\describe{
\item{\code{predicted_m6A_prob}}{Numeric vector of predicted probabilities
for the positive class.}
\item{\code{predicted_m6A_status}}{Character vector with values
\code{"Positive"} or \code{"Negative"}, based on
\code{positive_threshold}.}
}
}
\description{
Uses a fitted machine learning model (typically a random forest) to predict
m6A site probabilities and binary status labels for a data frame of input
features. The function standardises factor levels for categorical variables,
encodes the \code{DNA_5mer} feature into nucleotide position factors, and
appends prediction results as new columns.
}
\examples{
rf_fit <- readRDS(system.file("extdata", "rf_fit.rds", package="m6APrediction"))
example_data <- read.csv(system.file("extdata", "m6A_input_example.csv", package="m6APrediction"))
preds <- prediction_multiple(rf_fit, example_data, positive_threshold = 0.5)
head(preds)

}
